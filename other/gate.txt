Gate

AuthServiceProvider:

use Illuminate\Support\Facades\Gate;

# boot function
Gate::define('site_settings', function ($user) {
	$user = auth('admin')->user();
	return $user->role_id == 1 ? true : false;
});
		
Gate::define('permissions', function ($user, $module_code, $access_type) {
	$user = auth('admin')->user();
	foreach($user->permissions as $permission):
		if($permission->module_code == $module_code):
			switch($access_type):
					case 'create':
							return  $permission->rr_create == 1 ? true : false; 
						break;

					case 'edit':
							return  $permission->rr_edit == 1 ? true : false; 
						break;

					case 'view':
							return  $permission->rr_view == 1 ? true : false; 
						break;

					case 'delete':
							return  $permission->rr_delete == 1 ? true : false; 
						break;
					
					default:
						return false;
						break;
			endswitch;
		endif;
	endforeach;

	return false;

});

# Route
	Route::resource('members', MemberController::class)->middleware("can:admin,permissions,'members','view'");

# Controller
	$this->authorize('permissions', [ 'members', 'view' ]);

# view
	@can('permissions', ['members', 'view'])
		Members
	@endcan